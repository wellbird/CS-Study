# 13. 링크계층(1) & 14. 링크계층(2)
## 데이터 링크 계층의 서비스(역할)
-----
### Framing
- 데이터그램에 헤더(Header)와 트레일러(Trailer)를 붙여 프레임의 형태로 캡슐화
- MAC(Medium Access Control) 주소가 프레임 헤더에 들어있어 출처와 목적지를 구분
### 흐름 제어(Flow Control) : 생성되는 프레임들의 수를 소비되는 프레임의 수에 맞춰 조절
- Stop & Wait
    - 데이터를 보내고, ACK 응답을 받을 때까지 기다리는 방식
- Sliding Window
    - 여러 프레임을 한꺼번에 보낼 수 있으며 ACK 응답이 필요하지 않음
### 에러 제어(Error Control) : 에러를 감지하고 수정 또는 폐기 후 재전송
- 에러 유형
    - 단일 비트 에러(Single-Bit-Error) : 오직 하나의 비트가 변경된 에러
    - 다중 비트 에러(Multi-Bit-Error) : 두 개 이상의 비트가 변경된 에러
    - 버스트 에러(Burst-Error) : 두 개 이상의 연속정인 비트가 변경된 에러
- 에러 수정(Error Correction)
    - FEC(Forward Error Correction) : 전진 에러 수정
        - 송신측이 프레임에 부가적 데이터(Redundancy)를 첨가하여 전송하고, 수신측이 부가적 데이터로 에러 검출 및 에러 수정을 하는 방식
        - 에러 검출 시 재전송 요구 없이 스스로 수정
        - 송신측이 한 곳이고 수신측이 여러 곳일 때 재전송이 어려운, 채널환경이 열악한 곳 또는 높은 신뢰성이 요구되는 곳에서 주로 사용
        - 원래 비트보다 큰 확장 비트로 인해 전송 효율이 떨어짐
    - BEC(Backward Error Correction) : 후진 에러 수정
        - 송신 측이 프레임에 확장 비트를 첨가하여 전송하고, 수신측이 이를 토대로 에러를 검출 시 재전송을 송신 측에 요구(ARQ)하는 방식
- 에러 감지(Error Detection)
    - 패리티 검사(Parity Check)
        - 1의 개수를 짝수 개로 맞춰서 보낼 지(Even Parity), 홀수 개로 맞춰서 보낼 지(Odd Parity) 송신측과 수신측이 약속하고 여분의 비트(패리티 비트)를 채워 보냄
        - 수신측에서 전체 비트를 계산하고 패리티 비트를 다시 계산함으로 데이터 에러발생 여부를 알 수 있음
        - 패리티 검사는 단일 비트 에러와 같이 홀수 개의 에러만 검출할 수 있고, 짝수 개의 에러는 검출하지 못함
        - 이를 해결하기 위해 수평(LRC)과 수직(VRC)으로 패리티 비트를 추가하고 검사하는 2차원 패리티 검사(Two-dimensional Parity Check)가 나왔지만 수평 수직에서 짝수 개씩 똑같이 바뀐다면 검출이 불가능
    - 체크섬(Checksum)
        - 데이터 길이와 관계없이 에러를 검출하는 기법
        - 데이터 링크 계층보다는 네트워크 및 트랜스포트 계층에서 더 자주 사용되는 방법
        - 송신측에서 모든 바이트 데이터를 더한 후 캐리니블(최상위 니블, 가장 앞에 위치한 4바이트)를 버리고 2의 보수를 취해 체크섬을 만듬
        - 수신츠겡서 모든 바이트 데이터와 체크섬을 더한 후 캐리니블을 버리고 0x00이 나오면 에러가 발생하지 않은 것으로 판단
    - 순환중복검사(CRC)
        - 데이터에 에러가 발생했는지 확인하는 코드를 확장 데이터로 덧붙여 보내는 방식
        - 송신측에서 CRC발생 코드를 선정 후 CRC발생 코드의 최고 차수만큼 확장시킨 데이터와 CRC발생 코드를 mod-2연산을 이용해 나누고 나머지가 0이 아니라면 확장된 데이터에 나머지를 붙여 전송
        - 수신된 코드를 동일한 CRC발생 코드로 나눈 후 나머지가 0이면 에러가 발생하지 않은 것으로 판단
    - 해밍 코드(Hamming Code)
        - 하나의 데이터 단위에 충분한 패리티 비트를 추가해 에러를 검출하고 수정하는 방법
- ARQ(Automatic Repeat Request) : 프레임 손상 시 재전송이 수행되는 과정
    - Stop & Wait ARQ
        - 한개의 프레임만 수신
        - 손상된 프레임을 수신하였으면 NAK를 전송
        - 유휴 시간(Idle Time)내에 수신측에서 ACK 응답을 보내지 않을 때, 송신측에서는 프레임을 재전송
    - Go-Back-N ARQ
        - 여러 프레임을 한꺼번에 수신
        - 만약 받은 프레임 중 하나라도 문제가 있는 경우 모든 프레임을 폐기처리하고 NAK응답을 보냄
    - Selective Repeat ARQ
        - 여러 프레임을 한번에 수신
        - 문제가 생긴 프레임에 대해서만 NAK응답을 보냄
### 혼잡 제어(Congestion Control) : 링크가 다수의 프레임으로 혼잡할 때 이를 제어
- 채널 : 동시에 한명만 사용할 수 있는 미디어의 단위
- 채널 공유 프로토콜
    - 주파수 분할(FDMA)
        - 한 전송로의 대역폭을 여러 개의 작은 채널로 분할하여 여러 단말기가 동시에 이용하는 방식
    - 시 분할(TDMA)
        - 하나의 전송로 대역폭을 시간 슬롯으로 나누어 채널에 할당함으로써 몇 개의 채널들이 한 전송로의 시간을 분할하여 사용
    - 코드 분할(CDMA)
        - 데이터를 디지털화한 다음 그것을 가용한 전체 대역폭에 걸쳐 확산
    - Carrier Sense Multiple Access
        - 채널의 사용 중 여부를 알아내는 것
        - 채널이 사용 중이면 그 채널을 사용하지 않게 함
- 제어 기법
    - AIMD
        - 처음에 패킷을 하나씩 보내고 이것이 문제없이 도착하면 Window크기(단위 시간 내에 보내는 패킷의 수)를 1씩 증가시켜가며 전송하는 방법
        - 패킷 전송에 실패하거나 일정 시간을 넘으면 패킷의 보내는 속도를 절반으로 줄임
    - Slow Start(느린 시작)
        - 처음에 패킷을 하나씩 보내고 패킷이 문제없이 도착하면 ACK패킷마다 Window크기를 1씩 증가시켜가며 전송하는 방법
        - 혼잡 현상이 발생하면 Window크기를 1로 떨어뜨림
    - Fast Retransmit(빠른 재전송)
        - 패킷을 받는 쪽에 먼저 도착해야할 패킷이 도착하지 않고 다음 패킷이 도착한 경우에도 ACK를 보냄
    - Fast Recovery(빠른 회복)
        - 혼잡한 상태가 되면 Window크기를 1로 줄이지 않고 반으로 줄이고 선형증가 시키는 방법

## Ethernet
-----
- 데이터 링크 계층에서 사용하는 프로토콜로써 CSMA/CD 방식을 사용하여 여러 개의 컴퓨터가 공유 매체를 사용할 수 있게 해 주며, MAC 주소를 이용해서 데이터를 필요로 하는 컴퓨터에게만 전달할 수 있도록 해줌